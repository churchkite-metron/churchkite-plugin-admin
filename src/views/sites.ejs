<% layout('layout') -%>
    <div class="container">
        <h1>Registered Sites</h1>
        <% if (!sites || sites.length===0) { %>
            <div
                style="background:#fff3cd;border:1px solid #ffe69c;padding:.75rem 1rem;margin-bottom:1rem;color:#664d03;">
                No sites registered yet. Activate the connector on a WordPress site to see it here.
            </div>
            <% } %>
                <table>
                    <thead>
                        <tr>
                            <th>Site URL</th>
                            <th>Last Seen</th>
                            <th>Plugins</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% (sites || []).forEach(function(site){ %>
                            <tr>
                                <td><a href="/plugins?site=<%= encodeURIComponent(site.siteUrl) %>">
                                        <%= site.siteUrl %>
                                    </a></td>
                                <td>
                                    <%= site.lastSeen %>
                                </td>
                                <td>
                                    <%= (site.plugins || []).join(', ') %></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
</div>